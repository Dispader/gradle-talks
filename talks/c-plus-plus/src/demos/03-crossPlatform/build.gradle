apply plugin: 'cpp-lib'
apply plugin: 'cpp'

binaries.withType(NativeBinary) {
    if (toolChain == toolChains.visualCpp) {
        compilerArgs '/Zi', '/RTC1'
        linkerArgs '/DEBUG'
    } else {
        compilerArgs '-g'
    }
}

libraries {
    main {
        binaries.withType(SharedLibraryBinary) {
            define 'DLL_EXPORT'
        }
    }
}

cpp {
    sourceSets {
        test {
            lib libraries.main
        }
    }
}

executables {
    test {
        source cpp.sourceSets.test
    }
}

